<html>
<head>
<title>Magazine</title>
<link rel="stylesheet" href="magazine.css">
<script src="jquery.js"></script>
<script src="jquery.touchSwipe.js"></script>
<script src="jstorage.js"></script>

<script src="magazine.js"></script>

<script>
</script>


<script>

$(document).ready(function(){

	if(DEBUG){
		$('.splash').click(function(){
			$('.splash').fadeOut()
		})
	}


	$(window)
		.resize(function() {
			fitNPages(PAGES_VISIBLE)
		})
		.bind('hashchange', function(){
			setCurrentPage(loadURLState())
		})

	$('.viewer')
		.swipe({
			swipeStatus: swipeUpdate,
			// XXX change this to pinch...
			swipeUp: function(){
				togglePageView('off')
			},
			// XXX change this to pinch...
			swipeDown: function(){
				togglePageView('on')
			},
			// XXX for some reason this deos not bubble up the nested elements...
			click: function(evt, elem){
				if($(elem).hasClass('page')){
					setCurrentPage(elem)
				} else if($(elem).hasClass('content')){
					setCurrentPage($(elem).parents('.page').first())
				}
				return true
			}
		})
	$('.button.cover').swipe({click: goToMagazineCover})
	$('.button.next-article').swipe({click: nextArticle})
	$('.button.prev-article').swipe({click: prevArticle})

	loadState()

	togglePageView('on')

	// hide the splash screen...
	$(window).one('webkitTransitionEnd oTransitionEnd msTransitionEnd transitionend',
		function(){
			$('.splash').fadeOut()
		})
})


</script>
</head>
<body>

<div class="viewer">

	<!-- Splash screen -->
	<div class="splash noSwipe">
		<!-- XXX replace this with a background-image logo... -->
		<table width="100%" height="100%"><tr><td align="center" valign="middle">
			<h2><i>loading...</i></h2>
		</td></tr></table>
	</div>


	<!-- XXX Magazine title... -->

	<div class="top-toolbar">
		mooo
		<div class="button home">Home</div>
		<div class="button cover">Issue Cover</div>
		<div class="button prev-article">Prev Article</div>
		<div class="button next-article">Next Article</div>
	</div>
	<div class="bottom-toolbar">
	</div>

<div class="scaler">
<div class="aligner">
	<div class="magazine">
		<div class="cover page current">
			<div class="content">
				Magazine Cover
			</div>
		</div>

		<!-- XXX do we need a Magazine Credits page??? -->

		<div class="article">
			<div class="cover page">
				<div class="content">
					Article Cover<br>
					some more text...
				</div>
			</div>

			<!-- XXX do we need an Article Credits page??? -->

			<div class="page">
				<div class="content" style="border:solid red 1px">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
					<img src="img.jpg" height="100%"/>
				</div>
			</div>
			<div class="page">
				<div class="content">
					<img src="img.jpg" width="200%" style="margin-left: -50%; margin-top: -20%"/>
				</div>
			</div>
		</div>
		<div class="article">
			<div class="cover page">
				<div class="content">
					Article Cover
				</div>
			</div>

			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
		</div>
		<div class="article">
			<div class="cover page">
				<div class="content">
					Article Cover
				</div>
			</div>

			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
			<div class="page">
				<div class="content">
					Page
				</div>
			</div>
		</div>
	</div>
</div>
</div>
</div>


</body>
</html>
